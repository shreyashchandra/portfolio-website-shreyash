<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Real GitHub Contributions</title>

    <style>
      body {
        background: #0a0f1a;
        color: white;
        font-family: Arial;
        padding: 20px;
      }

      #calendar {
        display: flex;
        gap: 4px;
      }

      .col {
        display: flex;
        flex-direction: column;
        gap: 4px;
      }

      .cell {
        width: 12px;
        height: 12px;
        border-radius: 2px;
        background: #111827;
      }

      .tooltip {
        position: fixed;
        background: black;
        color: white;
        padding: 6px 8px;
        font-size: 12px;
        border-radius: 6px;
        display: none;
        z-index: 999;
      }
    </style>
  </head>
  <body>
    <h2>GitHub Contributions â€” <span id="uname">shreyashchandra</span></h2>

    <div id="calendar"></div>
    <div class="tooltip" id="tooltip"></div>

    <script>
      const username = "shreyashchandra";
      const calendar = document.getElementById("calendar");
      const tooltip = document.getElementById("tooltip");

      const PROXY = "https://github-contrib-proxy.vercel.app/api?user=";

      async function loadContributions() {
        const url = PROXY + username;

        const res = await fetch(url);
        const svgText = await res.text();

        // Parse SVG
        const parser = new DOMParser();
        const svg = parser.parseFromString(svgText, "image/svg+xml");
        const rects = [...svg.querySelectorAll("rect[data-date]")];

        // Build map
        const map = {};
        rects.forEach((r) => {
          const date = r.getAttribute("data-date");
          const count = parseInt(r.getAttribute("data-count"));
          map[date] = count;
        });

        // Convert to calendar columns (weeks)
        const weeks = {};
        rects.forEach((r) => {
          const x = r.getAttribute("x");
          if (!weeks[x]) weeks[x] = [];
          weeks[x].push(r);
        });

        Object.keys(weeks)
          .sort((a, b) => a - b)
          .forEach((x) => {
            const col = document.createElement("div");
            col.className = "col";

            weeks[x].forEach((r) => {
              const date = r.getAttribute("data-date");
              const count = parseInt(r.getAttribute("data-count"));
              const color = r.getAttribute("fill");

              const cell = document.createElement("div");
              cell.className = "cell";
              cell.style.background = color;
              cell.dataset.date = date;
              cell.dataset.count = count;

              cell.addEventListener("mouseenter", (e) => {
                tooltip.style.display = "block";
                tooltip.innerHTML = `<b>${count}</b> contributions<br>${date}`;
              });

              cell.addEventListener("mousemove", (e) => {
                tooltip.style.left = e.clientX + 10 + "px";
                tooltip.style.top = e.clientY + 10 + "px";
              });

              cell.addEventListener("mouseleave", () => {
                tooltip.style.display = "none";
              });

              col.appendChild(cell);
            });

            calendar.appendChild(col);
          });
      }

      loadContributions();
    </script>
  </body>
</html>
